<script>
document.addEventListener("DOMContentLoaded", () => {
  // Select all elements you want to lazy load
  const allElements = document.body.querySelectorAll("*");

  // Map to store original content keyed by element
  const elementContentMap = new Map();

  allElements.forEach(el => {
    // Store original content
    elementContentMap.set(el, el.innerHTML);
    // Clear content to delay rendering
    el.innerHTML = "";
  });

  // Intersection observer setup with some rootMargin to preload early
  const observer = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const el = entry.target;
        // Restore original content
        el.innerHTML = elementContentMap.get(el);
        // Stop observing loaded element
        obs.unobserve(el);
      }
    });
  }, { rootMargin: "200px" });

  // Observe all elements
  allElements.forEach(el => {
    observer.observe(el);
  });
});
</script>