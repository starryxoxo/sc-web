<script>
  // 1% overlay chance toggle (uncomment to re-enable)
  // const showOverlay = Math.random() < 0.01;

  // Current behavior: always show overlay for testing
  const showOverlay = true;

  // Simple cooldown to prevent immediate re-show after a retry
  let overlayCooldownUntil = 0;

  function canShowOverlay() {
    const now = Date.now();
    return now >= overlayCooldownUntil;
  }

  if (showOverlay && canShowOverlay()) {
    // Build the bottom-fixed retry button overlay
    const overlay = document.createElement('div');
    overlay.style.position = 'fixed';
    overlay.style.top = '0';
    overlay.style.left = '0';
    overlay.style.width = '100vw';
    overlay.style.height = '100vh';
    overlay.style.backgroundColor = 'black';
    overlay.style.color = 'white';
    overlay.style.display = 'flex';
    overlay.style.flexDirection = 'column';
    overlay.style.justifyContent = 'flex-end';
    overlay.style.alignItems = 'stretch';
    overlay.style.zIndex = '9999';
    overlay.style.paddingTop = '20px';
    overlay.style.paddingBottom = '0';

    // Spacer to push content away from bottom if needed
    const spacer = document.createElement('div');
    spacer.style.flex = '1';
    overlay.appendChild(spacer);

    // Centered message (still visible behind the button)
    const message = document.createElement('div');
    message.textContent = 'Unable to view this page.';
    message.style.textAlign = 'center';
    message.style.fontSize = '24px';
    message.style.margin = '0 auto';
    message.style.padding = '12px 16px';
    overlay.appendChild(message);

    // Retry button at bottom
    const retryButton = document.createElement('button');
    retryButton.textContent = 'Retry';
    retryButton.style.width = '100%';
    retryButton.style.padding = '25px';
    retryButton.style.fontSize = '16px';
    retryButton.style.cursor = 'pointer';
    retryButton.style.border = '0';
    retryButton.style.backgroundColor = '#ffffff';
    retryButton.style.color = '#000';
    retryButton.style.marginTop = '10px';
    retryButton.style.borderTop = '1px solid #555';
    retryButton.onclick = () => {
      // Remove overlay
      if (overlay && overlay.parentNode) {
        overlay.parentNode.removeChild(overlay);
      }
      // Set a 40-second cooldown to prevent immediate re-show
      overlayCooldownUntil = Date.now() + 40 * 1000;

      // Optional: if you re-enable the 1% logic, you can trigger it here after cooldown
      // e.g., you might re-run a function that decides to show again based on the cooldown
    };

    overlay.appendChild(retryButton);

    document.body.appendChild(overlay);
  }

  // Optional: if you want to reuse the old storage/retrieval logic later, keep it here
  // (not active in this minimal overlay-only version)
</script>